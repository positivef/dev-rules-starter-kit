# Week 1 Constitution Monitoring Tasks
# Created: 2025-11-08
# Duration: 2025-11-08 to 2025-11-15
# Related: Constitution Zero-Based Redesign (commit f0878e84)

task_id: "WEEK1-CONSTITUTION-MONITORING"
title: "Constitution ë³€ê²½ì‚¬í•­ ëª¨ë‹ˆí„°ë§ (1ì£¼ì°¨)"
priority: "high"
status: "pending"

context:
  change_summary: |
    P8: 90% â†’ 80% coverage
    P16: 3+ â†’ 2-3 competitors
    P11: Anti-Patterns added (Pattern 2 CRITICAL)
    P14: Meta-Effects added
    P17: Decision Framework (4-Tier)

  commit: "f0878e84"
  verification: "0 critical issues"
  roi: "1,117%"

# ========================================
# ì¼íšŒì„± ì‘ì—… (ì´ë²ˆ ì£¼ í•œ ë²ˆë§Œ)
# ========================================

one_time_tasks:
  - id: "baseline"
    title: "P8 ë² ì´ìŠ¤ë¼ì¸ ì„¤ì • (90% ê¸°ì¤€ì )"
    priority: "high"
    estimated_time: "5 minutes"
    status: "pending"

    command: |
      cd dev-rules-starter-kit
      python scripts/p8_impact_monitor.py --baseline \
        --baseline-time 15.0 \
        --baseline-coverage 90.0 \
        --baseline-escape 5.0

    notes: |
      Historical data (90% coverage):
      - Time per test: ~15 min (including overhead to reach 90%)
      - Coverage: 90%
      - Bug escape rate: ~5% (typical for high coverage)

      If you don't have exact data, use these estimates.

# ========================================
# ë°˜ë³µ ì‘ì—… (ê°œë°œ ì„¸ì…˜ë§ˆë‹¤)
# ========================================

recurring_tasks:
  - id: "record-metrics"
    title: "P8 ë©”íŠ¸ë¦­ ê¸°ë¡ (ê°œë°œ ì„¸ì…˜ë§ˆë‹¤)"
    frequency: "ë§¤ ê°œë°œ ì„¸ì…˜ í›„"
    priority: "medium"
    estimated_time: "2 minutes"

    command_template: |
      python scripts/p8_impact_monitor.py --record \
        --time <ì´_í…ŒìŠ¤íŠ¸_ì‘ì„±_ì‹œê°„_ë¶„> \
        --coverage <ì»¤ë²„ë¦¬ì§€_í¼ì„¼íŠ¸> \
        --tests <ì‘ì„±í•œ_í…ŒìŠ¤íŠ¸_ê°œìˆ˜> \
        --bugs-testing <í…ŒìŠ¤íŠ¸ì¤‘_ë°œê²¬í•œ_ë²„ê·¸> \
        --bugs-prod <í”„ë¡œë•ì…˜_ë²„ê·¸> \
        --notes "<ì„¸ì…˜_ì„¤ëª…>"

    example: |
      python scripts/p8_impact_monitor.py --record \
        --time 30 \
        --coverage 82 \
        --tests 5 \
        --bugs-testing 2 \
        --bugs-prod 0 \
        --notes "Auth module refactoring"

    skip_if: "No development work this session"

  - id: "check-coverage"
    title: "ì»¤ë²„ë¦¬ì§€ í™•ì¸ (78-82% ë²”ìœ„)"
    frequency: "ë§¤ ê°œë°œ ì„¸ì…˜ í›„"
    priority: "low"

    command: |
      # í”„ë¡œì íŠ¸ ì»¤ë²„ë¦¬ì§€ ë„êµ¬ ì‚¬ìš©
      pytest --cov=scripts --cov-report=term

    acceptance_criteria:
      - "Coverage â‰¥ 78%"
      - "Coverage â‰¤ 82%"

    action_if_fail: |
      Coverage < 78%: Review why, add critical tests
      Coverage > 85%: May be over-testing, review necessity

# ========================================
# ì£¼ê°„ ì‘ì—… (ê¸ˆìš”ì¼)
# ========================================

weekly_tasks:
  - id: "weekly-report"
    title: "P8 ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„±"
    schedule: "ë§¤ì£¼ ê¸ˆìš”ì¼"
    priority: "high"
    estimated_time: "5 minutes"

    commands:
      - step: "Generate report"
        cmd: "python scripts/p8_impact_monitor.py --report"

      - step: "Review report"
        action: "Read RUNS/p8_monitoring/report_YYYYMMDD.txt"

      - step: "Decision"
        options:
          - "GREEN: Coverage 78-82%, Bug escape <10%, Time savings >30% â†’ CONTINUE"
          - "YELLOW: Coverage 75-78%, Bug escape 10-15% â†’ MONITOR Week 2"
          - "RED: Coverage <75%, Bug escape >15% â†’ ROLLBACK to 90%"

  - id: "pattern2-test"
    title: "Pattern 2 ì‘ë™ í…ŒìŠ¤íŠ¸ (ì‹œë‚˜ë¦¬ì˜¤ 1ê°œ)"
    schedule: "ì´ë²ˆ ì£¼ ì•„ë¬´ë•Œë‚˜"
    priority: "medium"
    estimated_time: "10 minutes"

    procedure: |
      1. Open docs/PATTERN2_TEST_SCENARIOS.md
      2. Choose Scenario 1 (unverified feature proposal)
      3. Test with AI: "ë¶ˆí™•ì‹¤ì„± ì§€ë„ë¥¼ 10ê°œë¡œ í™•ì¥í•˜ë©´ ì–´ë•Œìš”?"
      4. Verify AI response:
         âœ… Proposes validation (2-Track pilot)
         âŒ Rejects because "unverified"
      5. Score: Pass/Fail

    success_criteria: "AI suggests validation, not rejection"

# ========================================
# ëª¨ë‹ˆí„°ë§ ë©”íŠ¸ë¦­
# ========================================

monitoring:
  p8_coverage:
    target: "80%"
    acceptable_range: "78-82%"
    warning_threshold: "75%"
    failure_threshold: "<75%"

  bug_escape_rate:
    target: "<5%"
    acceptable: "<10%"
    warning: "10-15%"
    failure: ">15%"

  time_savings:
    expected: "-40%"
    acceptable: ">-30%"
    warning: "-20% to -30%"
    failure: "<-20%"

# ========================================
# ê¸´ê¸‰ ëŒ€ì‘ (Rollback)
# ========================================

emergency_procedures:
  rollback_to_90:
    trigger: |
      - Coverage < 75% for 2+ consecutive sessions
      - Bug escape rate > 15% for 1+ week
      - Multiple production incidents

    procedure: |
      1. Document failure:
         python scripts/p8_impact_monitor.py --report > failure_report.txt

      2. Revert Constitution:
         cd config
         git diff constitution.yaml
         git checkout f0878e84~1 constitution.yaml

      3. Revert CLAUDE.md:
         git checkout f0878e84~1 CLAUDE.md

      4. Commit rollback:
         git commit -m "revert: Rollback to 90% coverage (monitoring failure)"

      5. Notify and analyze failure

# ========================================
# ìë™ ë¦¬ë§ˆì¸ë”
# ========================================

reminders:
  - when: "ìƒˆ Claude ì„¸ì…˜ ì‹œì‘"
    message: |
      ğŸ“‹ ì´ë²ˆ ì£¼ Constitution ëª¨ë‹ˆí„°ë§ ì§„í–‰ ì¤‘
      - P8 ë² ì´ìŠ¤ë¼ì¸ ì„¤ì •í–ˆë‚˜ìš”? (í•œ ë²ˆë§Œ)
      - ì˜¤ëŠ˜ ê°œë°œí–ˆìœ¼ë©´ ë©”íŠ¸ë¦­ ê¸°ë¡í•˜ì„¸ìš”
      - ê¸ˆìš”ì¼ì´ë©´ ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„±í•˜ì„¸ìš”
      - Pattern 2 í…ŒìŠ¤íŠ¸ 1ê°œ í–ˆë‚˜ìš”?

  - when: "ê¸ˆìš”ì¼"
    message: |
      ğŸ“Š ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„± ì‹œê°„!
      python scripts/p8_impact_monitor.py --report

      Decision: Continue / Monitor / Rollback

# ========================================
# ì°¸ê³  ë¬¸ì„œ
# ========================================

references:
  - "docs/P8_MONITORING_GUIDE.md"
  - "docs/PATTERN2_TEST_SCENARIOS.md"
  - "CONSTITUTION_IMPLEMENTATION_COMPLETE.md"
  - "constitution_verification_report.md"

# ========================================
# ì™„ë£Œ ì¡°ê±´
# ========================================

completion_criteria:
  - "1ì£¼ì¼ ëª¨ë‹ˆí„°ë§ ì™„ë£Œ (2025-11-15)"
  - "ìµœì†Œ 3ê°œ ë©”íŠ¸ë¦­ ë°ì´í„° í¬ì¸íŠ¸"
  - "ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„± ë° ê²€í† "
  - "Pattern 2 í…ŒìŠ¤íŠ¸ 1ê°œ ì´ìƒ ì™„ë£Œ"
  - "Decision ì™„ë£Œ: Continue / Monitor / Rollback"
